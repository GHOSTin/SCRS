<template name="resItem">
  {{#let profLength = p2s.length}}
  {{#each prof in p2s}}
  <tr>
    <td data-rowspan="{{_id}}-1" data-order="{{year}}">{{year}}</td>
    <td data-rowspan="{{_id}}-2" data-order="{{speciality}}">{{speciality}}</td>
    <td data-rowspan="{{_id}}-3" data-order="{{name}}">{{name}}</td>
    {{#with profession prof.profId}}
    <td>{{name}}</td>
    {{/with}}
    <td>{{prof.rank}}</td>
    <td class="text-center">{{prof.gild}}</td>
    <td class="text-center">{{prof.sector}}</td>
    <td>
    {{#with userData prof.controllerId}}
      {{profile.name}}
    {{/with}}
    </td>
    <td>
    {{#with userData prof.masterId}}
      {{profile.name}}
    {{/with}}
    </td>
    <td>
    {{#with userData prof.instructorId}}
      {{profile.name}}
    {{/with}}
    </td>
    {{#each results _id prof.profId}}
      <td class="text-center">{{this}}</td>
    {{/each}}
    {{#each x in plans _id prof.profId}}
      {{#if _isArray x}}
        {{#each x}}
          <td class="text-center">{{toFixed this 2}}</td>
        {{/each}}
      {{else}}
        {{#each _range 1 6 1}}
          <td class="text-center"></td>
        {{/each}}
      {{/if}}
    {{/each}}
  </tr>
  {{/each}}
  {{/let}}
</template>